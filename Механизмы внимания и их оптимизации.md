**–í–Ω–∏–º–∞–Ω–∏–µ (Attention)** –≤ –º–∞—à–∏–Ω–Ω–æ–º –æ–±—É—á–µ–Ω–∏–∏ ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º, –∏–º–∏—Ç–∏—Ä—É—é—â–∏–π —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–µ –∫–æ–≥–Ω–∏—Ç–∏–≤–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ –≤—ã–±–∏—Ä–∞—Ç—å –∏ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ –Ω–∞–∏–±–æ–ª–µ–µ –∑–Ω–∞—á–∏–º—ã—Ö —á–∞—Å—Ç—è—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–¥–∞—á–∏. –í–º–µ—Å—Ç–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Å–µ–π –≤—Ö–æ–¥–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ, –º–µ—Ö–∞–Ω–∏–∑–º –≤–Ω–∏–º–∞–Ω–∏—è –Ω–∞–∑–Ω–∞—á–∞–µ—Ç —Ä–∞–∑–Ω—ã–µ –≤–µ—Å–∞ (–±–∞–ª–ª—ã) —Ä–∞–∑–ª–∏—á–Ω—ã–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º –¥–∞–Ω–Ω—ã—Ö, –≤—ã–¥–µ–ª—è—è –±–æ–ª–µ–µ –≤–∞–∂–Ω—ã–µ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–∏ —ç–ª–µ–º–µ–Ω—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–ª–æ–≤–∞ –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏ –∏–ª–∏ –æ–±–ª–∞—Å—Ç–∏ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏). –≠—Ç–æ —É–ª—É—á—à–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª—è–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –±–æ–ª—å—à–∏–º–∏ –∏ —Å–ª–æ–∂–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª–∏–Ω–Ω—ã–º–∏ —Ç–µ–∫—Å—Ç–∞–º–∏ –∏–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –≤—ã—Å–æ–∫–æ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è. –ú–µ—Ö–∞–Ω–∏–∑–º –≤–Ω–∏–º–∞–Ω–∏—è —Å—Ç–∞–ª –∫–ª—é—á–µ–≤—ã–º –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ Transformer, –∫–æ—Ç–æ—Ä–∞—è —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ —É–ª—É—á—à–∏–ª–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ —Ç–∞–∫–∏—Ö –æ–±–ª–∞—Å—Ç—è—Ö, –∫–∞–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞ –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–µ –∑—Ä–µ–Ω–∏–µ.

–î–∞–ª–µ–µ –±—É–¥—É—Ç —É–∫–∞–∑–∞–Ω—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≤–Ω–∏–º–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –º–µ–Ω—è—é—Ç —Å—É—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º–∞, –Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É—é—Ç –µ–≥–æ –¥–ª—è —É–≤–µ–ª–µ—á–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Ä–æ—Å—Ç–∏ –∏–ª–∏ —É–º–µ–Ω—å—à–µ–Ω–∏—è –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏
#### **Multi-head attention**
–≤ –æ–±—â–µ–º –≤—Å–µ –¥–∞–ª–µ–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Å—Ç—Ä–æ—è—Ç—å—Å—è –ø–æ–≤–µ—Ä—Ö —ç—Ç–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
—Å—É—Ç—å –µ—ë –±—É–∫–≤–∞–ª—å–Ω–æ –≤ —Ç–æ–º, —á—Ç–æ –ø–æ—Å–ª–µ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è Q V –∏ K –º—ã –¥–µ–ª–∏–º –∏—Ö –Ω–∞ –Ω–µ—Å—Å–∫–æ–ª—å–∫–æ —á–∞—Å—Ç–µ–π –ø–æ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏ –∏ –∏—â–µ–º –ø–æ–¥–º–∞—Ç—Ä–∏—Ü—ã O (–∫–æ—Ç–æ—Ä—ã–µ —Å–æ—Å—Ç–æ–≤–ª—è—é—Ç –º–∞—Ç—Ä–∏—Ü—É –≤—ã—Ö–æ–¥–æ–≤ —Å–ª–æ—è –≤–Ω–∏–º–∞–Ω–∏—è) –¥–ª—è –∫–∞–∂–¥–æ–π –≥–æ–ª–æ–≤—ã –æ—Ç–¥–µ–ª—å–Ω–æ —á—Ç–æ —Å–æ–∫—Ä–∞—â–∞–µ—Ç –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—É—é —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∏ –∑–∞—Ç—Ä–∞—Ç—ã –ø–∞–º—è—Ç–∏, —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è —Å–∞–º–æ–≥–æ —Å–º—ã—Å–ª–∞ —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–µ–π –º—ã –º–æ–∂–µ–º —Ç–∞–∫–æ–µ –ø–æ–∑–≤–æ–ª–∏—Ç—å —Å–µ–±–µ —Ç–∫ –∫–∞–∂–¥–∞—è —á–∞—Å—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–∞ –º–æ–∂–µ—Ç –æ—Ç–≤–µ—á–∞—Ç—å –∑–∞ —Å–≤–æ–∏ —Å–º—ã—Å–ª–æ–≤—ã–µ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ—Ç–æ—Ä—ã–µ —Å–∞–º–∏ –º–µ–∂–¥—É —Å–æ–±–æ–π –Ω–µ —Å–∏–ª—å–Ω–æ —Å–≤—è–∑–∞–Ω—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä –∫–∞–∫ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –ø—Ä–µ–∂–¥–ª–æ–∂–µ–Ω–∏–π –∏ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã –æ–∫—Ä–∞—Å
#### **Multi Query Attention**
–û—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ –¢—É—Ç –∑–∞–ø—Ä–æ—Å—ã –æ—Å—Ç–∞—é—Ç—Å—è —Ç–µ–º–∏ –∂–µ, –∞ –≤–æ—Ç –∫–ª—é—á–∏ –∏ –∑–Ω–∞—á–µ–Ω–∏—è –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –≤–µ—Å–∞ –∏ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–π –≥–æ–ª–æ–≤—ã, –∞—Ä–≥—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ —ç—Ç–æ —Ç–µ–º, —á—Ç–æ –∫–∞–∂–¥–∞—è –≥–æ–ª–æ–≤–∞ –¥–µ–ª–∞–µ—Ç —Ä–∞–∑–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (—Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è), –Ω–æ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö –æ–¥–Ω–∏.
**Q (–∑–∞–ø—Ä–æ—Å—ã)**: –û–ø—Ä–µ–¥–µ–ª—è—é—Ç, _–Ω–∞ —á—Ç–æ –æ–±—Ä–∞—â–∞—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ_. –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –¥–ª—è –∫–∞–∂–¥–æ–π –≥–æ–ª–æ–≤—ã, –æ–Ω–∏ –æ—Ç–≤–µ—á–∞—é—Ç –∑–∞ **—Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤** (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–∏–Ω—Ç–∞–∫—Å–∏—Å, —Å–µ–º–∞–Ω—Ç–∏–∫–∞, –∞–Ω–∞—Ñ–æ—Ä—ã).
**K (–∫–ª—é—á–∏)** –∏ **V (–∑–Ω–∞—á–µ–Ω–∏—è)**: –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç _–∫–æ–Ω—Ç–µ–∫—Å—Ç_. –ò—Ö –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –æ–±—â–∏–º–∏, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –æ–ø–∏—Å—ã–≤–∞—é—Ç –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –∞ –Ω–µ —Ñ–æ–∫—É—Å –≤–Ω–∏–º–∞–Ω–∏—è.
–Ω–µ–º–Ω–æ–≥–æ —É—Ö—É–¥—à–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ (–Ω–∞ 1-3%), –Ω–æ —É–ª—É—á—à–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å –ø–∞–º—è—Ç—å—é (–≤ 2-3 —Ä–∞–∑–∞) –∏ —É–º–µ–Ω—å—à–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π (–Ω–∞ 40%+-) 
#### Grouped Query Attention by ü¶ô3**
–ì–æ–ª–æ–≤—ã –≤–Ω–∏–º–∞–Ω–∏—è –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è –≤ **–≥—Ä—É–ø–ø—ã** (–Ω–∞–ø—Ä–∏–º–µ—Ä, 8 –≥—Ä—É–ø–ø –ø–æ 4 –≥–æ–ª–æ–≤—ã –≤ –∫–∞–∂–¥–æ–π –¥–ª—è –º–æ–¥–µ–ª–∏ —Å 32 –≥–æ–ª–æ–≤–∞–º–∏).
–í–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã –≥–æ–ª–æ–≤—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç **–æ–±—â–∏–µ –º–∞—Ç—Ä–∏—Ü—ã –∫–ª—é—á–µ–π (K)** –∏ **–∑–Ω–∞—á–µ–Ω–∏–π (V)**, –Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ **–∑–∞–ø—Ä–æ—Å—ã (Q)**.	
–ª—É—à—á–∏–π –ø–æ–¥—Ö–æ–¥ —Ç–∫ —Å–æ–≤–º–µ—â–∞–µ—Ç —ç–∫–æ–Ω–æ–º–∏—é MQA –∏ –ö–∞—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ attention
#### **FLASH Attention**
1. **–†–∞–∑–±–∏–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü**

- –ú–∞—Ç—Ä–∏—Ü—ã `Q`, `K`, `V` –¥–µ–ª—è—Ç—Å—è –Ω–∞ –±–ª–æ–∫–∏ `{Q_i}`, `{K_j}`, `{V_j}`, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–µ—â–∞—é—Ç—Å—è –≤ –±—ã—Å—Ç—Ä—É—é –ø–∞–º—è—Ç—å (SRAM).
	

1. **–í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã —Å –∞–∫–∫—É–º—É–ª—è—Ü–∏–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫**

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ `Q_i`:

- **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫**:
	
	- `m_i = -‚àû` (—Ç–µ–∫—É—â–∏–π –º–∞–∫—Å–∏–º—É–º –¥–ª—è –≤—Å–µ—Ö –∫–ª—é—á–µ–π, –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–ª—è `Q_i`),
		
	- `l_i = 0` (—Ç–µ–∫—É—â–∞—è —Å—É–º–º–∞ —ç–∫—Å–ø–æ–Ω–µ–Ω—Ç –¥–ª—è `Q_i`),
		
	- `O_i = 0` (–∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä –≤—ã—Ö–æ–¥–∞).
		

–î–ª—è –≤—Å–µ—Ö –±–ª–æ–∫–æ–≤ –∫–ª—é—á–µ–π –∏ –∑–Ω–∞—á–µ–Ω–∏–π `K_j`, `V_j`:

- **–®–∞–≥ 1: –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø–æ–¥–º–∞—Ç—Ä–∏—Ü—ã `S_ij = Q_i K_j^T / sqrt(d_k)`**  
	(–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤).
	
- **–®–∞–≥ 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫ `m_i` –∏ `l_i`**  
	–î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ `s` –≤ `S_ij` (—Ç.–µ. –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –≤ `Q_i`):
	
	- –õ–æ–∫–∞–ª—å–Ω—ã–π –º–∞–∫—Å–∏–º—É–º –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –±–ª–æ–∫–∞:  
		`m_local = max(s)`.
		
	- –ù–æ–≤—ã–π –≥–ª–æ–±–∞–ª—å–Ω—ã–π –º–∞–∫—Å–∏–º—É–º:  
		`m_new = max(m_i, m_local)`.
		
	- –ö–æ—Ä—Ä–µ–∫—Ü–∏—è —Å—É–º–º —ç–∫—Å–ø–æ–Ω–µ–Ω—Ç:  
		`l_new = e^{m_i - m_new} * l_i + e^{m_local - m_new} * sum(exp(s - m_local))`.
		
	- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `m_i = m_new`, `l_i = l_new`.
		
- **–®–∞–≥ 3: –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤–µ—Å–æ–≤ –≤–Ω–∏–º–∞–Ω–∏—è –¥–ª—è –±–ª–æ–∫–∞ `K_j`**  
	–î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ `s` –≤ `S_ij`:
	
	- –ù–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ–Ω–µ–Ω—Ç—ã:  
		`P_ij = exp(s - m_i) / l_i`.
		
	- –£–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞ –∑–Ω–∞—á–µ–Ω–∏—è `V_j`:  
		`O_i += P_ij * V_j`.
		

1. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫ –¥–ª—è backward pass**

- `m_i` –∏ `l_i` —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞ `Q_i`, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø–µ—Ä–µ—Å—á—ë—Ç–∞ –ø–æ–ª–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã –≤–Ω–∏–º–∞–Ω–∏—è –ø—Ä–∏ –æ–±—Ä–∞—Ç–Ω–æ–º —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–∏.
#### **Sparse Attention**
 (—Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ) ‚Äî —ç—Ç–æ –ø–æ–¥—Ö–æ–¥, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –º–æ–¥–µ–ª—å –≤—ã—á–∏—Å–ª—è–µ—Ç **–Ω–µ –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è** –º–µ–∂–¥—É —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –∞ —Ç–æ–ª—å–∫–æ **–∏–∑–±—Ä–∞–Ω–Ω—ã–µ –ø–∞—Ä—ã**, —á—Ç–æ —Ä–µ–∑–∫–æ —Å–Ω–∏–∂–∞–µ—Ç –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ self-attention (–≥–¥–µ –∫–∞–∂–¥—ã–π —Ç–æ–∫–µ–Ω –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å–æ –≤—Å–µ–º–∏), sparse attention –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∑–∞—Ä–∞–Ω–µ–µ –∑–∞–¥–∞–Ω–Ω—ã–µ –∏–ª–∏ –æ–±—É—á–∞–µ–º—ã–µ **–ø–∞—Ç—Ç–µ—Ä–Ω—ã —Å–≤—è–∑–µ–π**, —á—Ç–æ–±—ã —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ –Ω–∞–∏–±–æ–ª–µ–µ –≤–∞–∂–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö.

 –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?

- **–ü—Ä–æ–±–ª–µ–º–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è**: –í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å O(n2)O(n2) –¥–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª–∏–Ω—ã nn –¥–µ–ª–∞–µ—Ç –µ–≥–æ –Ω–µ–ø—Ä–∞–∫—Ç–∏—á–Ω—ã–º –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–µ–∫—Å—Ç—ã –∏–∑ 10 000+ —Ç–æ–∫–µ–Ω–æ–≤, –≤–∏–¥–µ–æ).
	
- **–¶–µ–ª—å sparse attention**: –°–Ω–∏–∑–∏—Ç—å —Å–ª–æ–∂–Ω–æ—Å—Ç—å –¥–æ O(n), O(nlogn) –∏–ª–∏ O(nsqrt(n)), —Å–æ—Ö—Ä–∞–Ω–∏–≤ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ —É–ª–∞–≤–ª–∏–≤–∞—Ç—å –∫–ª—é—á–µ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.
#### **Native Sparse Attention by üêã**
–æ–¥–Ω–∞ –∏–∑ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π Sparse Attention, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω–∞—è deepseek, –±—É–∫–≤–∞–ª—å–Ω–æ –≤—ã–±–∏—Ä–∞–µ—Ç, –∫–∞–∫–∏–µ —á–∞—Å—Ç–∏ –≤—Å–µ–≥–æ —Ç–µ–∫—Å—Ç–∞ –¥–æ–±–∞–≤–ª—è—Ç—å –≤ –º–µ—Ö–∞–Ω–∏–∑–º –≤–Ω–∏–º–∞–Ω–∏—è, —á—Ç–æ–±—ã –Ω–µ –∏—Å–∫–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ –≤—Å–µ–≥–æ –≤—Ö–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –∞ —Ç–æ–ª—å–∫–æ –∏–∑ –µ–≥–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —á–∞—Å—Ç–µ–π, —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –≤ —Ç–æ–º, —á—Ç–æ –µ—Å—Ç—å sliding context window, –æ–Ω–∞ –≥–æ–≤–æ—Ä–∏—Ç —á—Ç–æ N —Ç–æ–∫–µ–Ω–æ–≤ –±–ª–∏–∑–∫–∏—Ö –∫ –¥–∞–Ω–Ω–æ–º—É –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –≤ –ø–æ–∏—Å–∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ –ª—é–±–æ–º —Å–ª—É—á–∞–µ + –º—ã –±–µ—Ä—ë–º —Ç–µ–∫—Å—Ç –∏ —Ä–∞–∑–¥–µ–ª—è–µ–º –µ–≥–æ –Ω–∞ –≥—Ä—É–ø–ø—ã –∏ –Ω–∞—Ö–æ–¥–∏–º –¥–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã —Å–≤–æ–π —ç–º–±–µ–¥–¥–∏–Ω–≥, –∑–∞—Ç–µ–º –º—ã –∏—â–µ–º top-n —Å–∞–º—ã—Ö —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –≥—Ä—É–ø–ø –∫ –≥—Ä—É–ø–ø–µ –Ω–∞—à–µ–≥–æ —Ç–æ–∫–µ–Ω–∞ —á–µ—Ä–µ–∑ –∫–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –∏–ª–∏ –º–æ–∂–µ—Ç —á–µ—Ä–µ–∑ —Å–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ Querry –∏ Key —ç–º–±–µ–¥–æ–≤ –≥—Ä—É–ø–ø, –∑–∞—Ç–µ–º –º—ã –≤—ã–±–∏—Ä–∞–µ–º —ç—Ç–∏ n –≥—Ä—É–ø–ø –∏ –¥–æ–±–∞–≤–ª—è–µ–º –∏—Ö —Ç–æ–∫–µ–Ω—ã –≤ –ø–æ–∏—Å–∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

—Ç–∞–∫–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º gates, –∫–æ—Ç–æ—Ä—ã–π –≥–æ–≤–æ—Ä–∏—Ç –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å–∏–ª—ë–Ω –≤–∫–ª–∞–¥ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã –≤ –≤–µ—Å—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è —Ç–µ–∫—É–∂–µ

–¥–ª—è —Å–∂–∞—Ç–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤ –≤ –≥—Ä—É–ø–ø—ã –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ä–∞–∑–Ω—ã–µ –≤–∏–¥—ã –ø—É–ª–∏–Ω–≥–∞, –Ω–æ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º deepseek –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —á—Ç–æ-—Ç–æ –ø–æ—Ö–æ–∂–µ–µ –Ω–∞ weighted mean pulling, –≤–µ—Å–∞ –ø–æ–ª—É—á–∞—é—Ç—Å—è –∫–∞–∫ –ø—Ä–æ—Ö–æ–¥ –æ–¥–Ω–æ–≥–æ –ø–µ—Ä—Ü–µ–ø—Ç—Ä–æ–Ω–∞ —Å –¥–≤—É–º—è —Å–ª–æ—è–º–∏ + GELU, –∫–æ—Ç–æ—Ä—ã–π –±–µ—Ä—ë—Ç –Ω–∞ –≤—Ö–æ–¥–µ —ç–º–±–µ–¥ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–∫–∞–ª—è—Ä (–≤–µ—Å), –∑–∞—Ç–µ–º —ç—Ç–∏ –≤–µ—Å–∞ –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ softmax –∏ –ø—Ä–µ–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –≤–µ—Å–∞ –¥–ª—è –≤–≤–µ—â–µ–Ω–Ω–æ–π —Å—É–º–º—ã

---
–•–æ—Ä–æ—à–µ–µ —Ä–µ—à–µ–Ω–∏–µ Flash attention v2 + GQA (—Ç–∞–∫–æ–µ —Å–¥–µ–ª–∞–ª–∏ –≤ llama-3)
–ª—É—á—à–µ–µ —Ä–µ—à–µ–Ω–∏–µ Flash attention v2 + GQA + NSA (—ç—Ç–æ–≥–æ –µ—â—ë –Ω–µ—Ç)